@*@model IEnumerable<ClubMembership.Models.CustomerMaster>*@
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="col-lg-12">
    <div class="panel panel-primary">
        <div class="panel-heading">
            <h3 class="panel-title"><i class="fa fa-bar-chart-o fa-fw"></i>  Customer Master <a class="btn btn-danger btn-sm pull-right" style="padding:3px;margin:0 0 10px" href="@Url.Action("Form", "CustomerMaster")"><i class="fa fa-plus-square "></i> Add New </a> <div class="clearfix"> </div></h3>
        </div>
        <div class="col-lg-12" style="margin-top:10px">
            <div class="alert alert-info  center-block " style="text-align:center">
                <input class="uname form-control hide" id="uname" name="uname" value="@Session["BRNCHNAME"]" />

                <form action="#" method="post" accept-charset="utf-8" id="exportcartingorderform" data-ng-controller="myController" name="exportcartingorderform">

                    <label for="BranchName">Branch Name</label>

                    @Html.DropDownList("BRNCHID", null, new { @class = "BRNCHID", @id = "BRNCHID", @name = "BRNCHID" })
                    <input type="text" value="@ViewBag.F_BRNCHID" id="F_BRNCHID" name="F_BRNCHID" class="form-control F_BRNCHID hidden" />
                    <input type="text" value="@ViewBag.F_BRNCHNAME" id="F_BRNCHNAME" name="F_BRNCHNAME" class="form-control F_BRNCHNAME hidden" />
                    <input type="text" value="@System.Web.HttpContext.Current.Session["Group"]" id="F_KUSRID" class="hidden" />
                    @*<label for="from">From</label>
                    <input type="text" id="from" name="from" value="@System.Web.HttpContext.Current.Session["SDATE"]">
                    <label for="to">to</label>
                    <input type="text" id="to" name="to" value="@System.Web.HttpContext.Current.Session["EDATE"]">*@
                    <input type="submit" name="submit" value="Search" class="btn btn-danger btn-sm" />
                    <div class="row ">
                        <br />
                        <label>Select Option</label> &nbsp;&nbsp;
                        <input type="radio" value="0" class="" name="type" checked />  A &nbsp;&nbsp;
                        <input type="radio" value="1" class="" name="type" />   B &nbsp;&nbsp;
                        @*<input type="radio" value="2" class="hide" name="type" />   C &nbsp;&nbsp;*@
                        <br />
                    </div>
                </form>

            </div>
        </div>
        <div>
            <div class="row">
                <div class="col-md-12">
                    <div class=" ">
                        <div class="panel-body">

                            <table id="example" class="display" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th>Branch Name</th>
                                        <th>Code</th>
                                        <th>Name</th>
                                        <th>Customer Id Proof</th>
                                        <th>Mobile No.</th>
                                        <th>Status</th>
                                        <th>ID</th>
                                        <th>Edit / Delete</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                    <tr>
                                        <th>Branch Name</th>
                                        <th>Code</th>
                                        <th>Name</th>
                                        <th>Customer Id Proof</th>
                                        <th>Mobile No.</th>
                                        <th>Status</th>
                                        <th>ID</th>
                                        <th>Edit / Delete</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



@section Scripts {

    <script type="text/javascript" class="init">

        var editor; // use a global for the submit and return data rendering in the examples
        $(document).ready(function () {
            $("#BRNCHID").on("change", function () {
                // var bname = $('#F_BRNCHID :selected').text();
                //  var bid = $('#F_BRNCHID :selected').val();

                var bname = $('#BRNCHID :selected').text();
                var bid = $('#BRNCHID :selected').val();
                //    alert(bname);
                //      alert(bid);
                $("#F_BRNCHID").val(bid);
                $("#F_BRNCHNAME").val(bname);
                //$("#F_BRNCHID").val($(this).find("option:selected").text());

            });


            if ($("#F_KUSRID").val() == "Admin" || $("#F_KUSRID").val() == "Manager") {
                if ($("#F_BRNCHID").val() == 0) $(".BRNCHID").append("<option value=0 selected>Of All Branches</option>");
                else $(".BRNCHID").append("<option value=0>Of All Branches</option>");
            }
            var uname = ($(".uname").val());


   //     alert("3");
            

   //     alert("3");

        table=$('#example').DataTable( {
            ajax: "@Url.Action("GetAjaxData", "CustomerMaster")",
            stateSave: true,
            //datatype: JSON,
            columns: [
                { data: "BRNCHNAME"},
                    { data: "CATECODE" },
                    { data: "CATENAME" },
                    { data: "CATEPROOFNAME" },
                    { data: "CATEPHN1" },
                    { data: "DISPSTATUS" },
                    { data: "CATEID","visible": false },
			        {
			            mRender: function (data, type, row) {
                            return '<a href="@Url.Action("Form", "CustomerMaster")/' + row["CATEID"] + '"   class="editor_edit btn btn-warning btn-sm" ><i class="glyphicon glyphicon-pencil"></i></a>&nbsp;<a href="#" id="' + row["CATEID"] + '\" class="editor_remove btn btn-danger btn-sm" ><i class="fa fa-trash-o"></i></a>'
			            }
			            //data: null,
				        //className: "center",
				        //defaultContent: '<a href="" class="editor_edit btn btn-warning btn-sm">Edit</a> &nbsp; <a href="" class="editor_remove btn btn-sm btn-danger">Delete</a>'
			        }
		        ]
        });

   //         alert("4");
            //--------------Delete Record----------------//
            $(document).on("click", "a.editor_remove", function () {
                var r = confirm("Are you sure to delete this record ?");
                if (r == true) {
                    var idx = $(this).attr('id');
                    base = window.location.origin;
                    $.post(base + "/CustomerMaster/Del",
                          {
                              id: idx, fld: ""
                          },
                        function (data, status) {
                            if (data == "Deleted Successfully ...")
                                location.replace(base + "/CustomerMaster/Index");
                            else if (data == "") alert("You are not authorize to Delete..!");
                            else
                                alert(data);
                        });
                }
                return false;
            });//end


  //      alert("5");


            $("#from").datepicker({
                defaultDate: "+1w",
                changeMonth: true,
                numberOfMonths: 3,
                dateFormat: 'dd-mm-yy',
                onClose: function (selectedDate) {
                    $("#to").datepicker("option", "minDate", selectedDate);
                }
            });
            $("#to").datepicker({
                defaultDate: "+1w",
                changeMonth: true,
                numberOfMonths: 3,
                dateFormat: 'dd-mm-yy',
                onClose: function (selectedDate) {
                    $("#from").datepicker("option", "maxDate", selectedDate);
                }
            });




  //      alert("6");



} );



    </script>

}

